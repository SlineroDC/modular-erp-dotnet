<div id="importModal" class="relative z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    
    <div class="fixed inset-0 bg-gray-900/75 transition-opacity backdrop-blur-sm"></div>

    <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
        <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
            
            <div class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg dark:bg-gray-800 border dark:border-gray-700">
                
                <div class="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4 dark:bg-gray-800">
                    <div class="sm:flex sm:items-start">
                        
                        <div class="mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-green-100 sm:mx-0 sm:h-10 sm:w-10 dark:bg-green-900/30">
                            <span class="material-symbols-outlined text-green-600 dark:text-green-400">table_view</span>
                        </div>
                        
                        <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full">
                            <h3 class="text-base font-semibold leading-6 text-gray-900 dark:text-white">Import Products</h3>
                            
                            <div class="mt-4 rounded-md bg-blue-50 p-4 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 text-left">
                                <div class="flex">
                                    <div class="flex-shrink-0">
                                        <span class="material-symbols-outlined text-blue-400 dark:text-blue-300 text-xl">info</span>
                                    </div>
                                    <div class="ml-3 flex-1">
                                        <p class="text-sm text-blue-700 dark:text-blue-300 font-medium">
                                            File Requirements:
                                        </p>
                                        <p class="text-xs text-blue-600 dark:text-blue-400 mt-1">
                                            The Excel file must have headers in the first row and follow this exact order:
                                        </p>
                                    </div>
                                </div>
                                
                                <div class="mt-3 overflow-hidden rounded border border-blue-200 dark:border-blue-700">
                                    <table class="min-w-full text-xs text-left text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800">
                                        <thead class="bg-blue-100/50 dark:bg-blue-900/40 font-bold text-gray-700 dark:text-gray-300">
                                            <tr>
                                                <th class="px-2 py-1 border-r border-blue-100 dark:border-blue-800">A: Name</th>
                                                <th class="px-2 py-1 border-r border-blue-100 dark:border-blue-800">B: Price</th>
                                                <th class="px-2 py-1 border-r border-blue-100 dark:border-blue-800">C: Stock</th>
                                                <th class="px-2 py-1">D: Desc.</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>

                                <div class="mt-3 text-right">
                                    <a href="~/files/template.xlsx" download class="inline-flex items-center text-xs font-bold text-blue-700 hover:text-blue-800 dark:text-blue-300 dark:hover:text-blue-200 hover:underline decoration-blue-700/30 dark:decoration-blue-300/30">
                                        <span class="material-symbols-outlined text-sm mr-1">download</span>
                                        Download Template (.xlsx)
                                    </a>
                                </div>
                            </div>

                            <form method="post" enctype="multipart/form-data" asp-page-handler="Import" class="mt-6">
                                
                                <div class="flex justify-center rounded-lg border-2 border-dashed border-gray-300 px-6 py-8 hover:bg-gray-50 dark:border-gray-600 dark:hover:bg-gray-700/50 transition-colors group">
                                    <div class="text-center">
                                        <span class="material-symbols-outlined text-4xl text-gray-400 group-hover:text-constructor-blue dark:group-hover:text-blue-400 transition-colors">cloud_upload</span>
                                        <div class="mt-4 flex text-sm leading-6 text-gray-600 dark:text-gray-400 justify-center">
                                            <label for="file-upload" class="relative cursor-pointer rounded-md font-semibold text-constructor-blue focus-within:outline-none focus-within:ring-2 focus-within:ring-constructor-blue focus-within:ring-offset-2 hover:text-blue-500 hover:underline dark:text-blue-400">
                                                <span>Click to upload</span>
                                                <input id="file-upload" name="UploadedFile" type="file" accept=".xlsx" class="sr-only" required onchange="showFileName(this)">
                                            </label>
                                            <p class="pl-1">or drag and drop</p>
                                        </div>
                                        <p class="text-xs leading-5 text-gray-500 dark:text-gray-500 mt-1">.XLSX files only (max 10MB)</p>
                                        
                                        <p id="file-name" class="mt-3 text-sm font-bold text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20 py-1 px-2 rounded hidden border border-green-200 dark:border-green-800"></p>
                                    </div>
                                </div>

                                <div class="mt-5 sm:mt-6 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3">
                                    <button type="submit" class="inline-flex w-full justify-center rounded-md bg-[#003366] px-3 py-2 text-sm font-semibold text-white shadow-sm hover:opacity-90 sm:col-start-2 transition-opacity">
                                        Import Products
                                    </button>
                                    <button type="button" onclick="closeImportModal()" class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:col-start-1 sm:mt-0 dark:bg-gray-700 dark:text-gray-300 dark:ring-gray-600 dark:hover:bg-gray-600 transition-colors">
                                        Cancel
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>